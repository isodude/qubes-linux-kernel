diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_irq.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_irq.c
index cc2e0c9cfe0a..ccf0790b4638 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_irq.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_irq.c
@@ -314,20 +314,19 @@ int amdgpu_irq_init(struct amdgpu_device *adev)
 	adev->irq.msi_enabled = false;
 
 	if (amdgpu_msi_ok(adev)) {
-		int nvec = pci_msix_vec_count(adev->pdev);
-		unsigned int flags;
-
-		if (nvec <= 0) {
-			flags = PCI_IRQ_MSI;
-		} else {
-			flags = PCI_IRQ_MSI | PCI_IRQ_MSIX;
-		}
 		/* we only need one vector */
-		nvec = pci_alloc_irq_vectors(adev->pdev, 1, 1, flags);
+		int nvec = pci_alloc_irq_vectors(adev->pdev, 1, 1, PCI_IRQ_MSIX);
 		if (nvec > 0) {
 			adev->irq.msi_enabled = true;
-			dev_dbg(adev->dev, "using MSI/MSI-X.\n");
+			dev_dbg(adev->dev, "using MSI-X.\n");
+		} else {
+			nvec = pci_alloc_irq_vectors(adev->pdev, 1, 1, PCI_IRQ_MSI);
+			if (nvec > 0) {
+				adev->irq.msi_enabled = true;
+				dev_dbg(adev->dev, "using MSI.\n");
+			}
 		}
+
 	}
 
 	if (!amdgpu_device_has_dc_support(adev)) {
-- 
2.26.2

